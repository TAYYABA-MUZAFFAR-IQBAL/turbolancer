<!DOCTYPE html>
<html data-lt-installed="true"
>

<head>
  <title>Check Existing Images and Set Div Colors</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    *{
      transition: all 0.3s;
    }

    .card {
      text-wrap:balance;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      display: block;
      float: left;
      margin: 10px;
      width: 100%;
      transition: all 0.3s;
      max-width: 300px;
      color: #fff;
            position: relative;
      text-align: left;
      background-image: linear-gradient(transparent, #ffffff54, transparent);
    }

    .card .cardimg {
      display: none;
      height: 170px;
      width: 100%;
      object-fit: fill;
      margin-bottom: 10px;
      border-radius: 8px;
    }
.card .reqimg{
  display: block;
}
 

    .card p {
      font-size: 18px;
      font-weight: 500;
      margin-bottom: 10px;
    }

    .card span {
      font-size: 16px;
    }

    .card a {
      background-color: #f1f1f1;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      display: inline-block;
      font-size: 14px;
      margin-top: 10px;
      padding: 8px 16px;
      text-decoration: none;
      transition: background-color 0.3s;
    }

    .card a:hover {
      background-color: #e6e6e6;
    }

    .pro {
      display: grid;
      grid-template-columns: 31px auto;
      width: 100%;
      height: 34px;
      align-items: center;
      justify-content: left;
      gap: 4px;
      font-size: 23px;
    }

    .pro h5 {
      line-height: 30px;
      text-align: left;
      margin-left: 7px;
      margin-top: 25px;
      font-weight: bolder;
      font-size: 16px;
    }

    .pro img {
      width: 30px;
      height: 30px;
      border-radius: 50px;
    }
    .price{
      text-align: right !important;
      float: right !important;
      margin-right: 10px;
      font-size: 22px !important;
    }
    .pro,.card p, .price, .ratting  {
      margin-left: 10px;
    }

    .after{
      width: 50px;
      height:50px;
      border-radius: 50px;
      background-color: #fff;
      box-shadow: 0 5px 10px #0002;
      position: absolute;
      color: #000;
      top: 18%;
      right: 1%;
      font-weight: bold;
      font-size: 26px;
      display: none;
      justify-content: center;
      align-items: center;
      transform: translateX(100%);
      opacity: 0;
      transition: all 0.4s;
      font-family: Arial, Helvetica, sans-serif;
cursor: pointer;

    }
.after.show{
  transform: translateX(0%);
      opacity: 1;
      transition: all 0.4s;
}
.before.show{

  transform: translateX(0%);
      opacity: 1;
      transition: all 0.4s;

}
.reqimg{
  animation-name: come;
  animation-duration: 0.4s;
  animation-timing-function: linear;
  animation-iteration-count: 1;
}

@keyframes come {
  from{
    opacity: 0;
    transform: scale(1.05);
  }
  to{
    opacity: 1;
    transform: scale(1);
  }
  
}
    .before{
      transition: all 0.4s;
display: none;
      transform: translateX(-100%);
      opacity: 0;
      width: 50px;
      height:50px;
      border-radius: 50px;
      background-color: #fff;
      box-shadow: 0 5px 10px #0002;
      position: absolute;
      color: #000;
      top: 18%;
      left: 1%;
      font-weight: bold;
      font-size: 26px;
      justify-content: center;
      align-items: center;
      font-family: Arial, Helvetica, sans-serif;
cursor: pointer;
    }
 .pro img.live{
border: none;
outline:3px solid rgb(21, 255, 0);
border-radius: 50%;

outline-offset: 3px;




 }
  </style>
</head>

<body>
  <div class="imageDiv card" onmouseenter="show(this)" onmouseleave="hide(this)">
     <div class="after" onclick="next(this)">↪</div>
    <div class="before" onclick="back(this)">↩</div>
     <img src="banner.jpg" class="cardimg reqimg" alt="Rajib Khan">
     <img src="download.jpg" class="cardimg" alt="Rajib Khan">
     <img src="OIP.jpg" class="cardimg" alt="Rajib Khan">
     <img src="4723250.jpg" class="cardimg" alt="Rajib Khan">
    <span class="pro">
      <img class="live" src="4723250.jpg" alt="Rajib Khan">
      <h5>Rajib Khan</h5>     

    </span><br>
    <p>I will do web application in java python c-Sharp with angular.</p> <br><span class="ratting"><b> ★ 5.0</b> <t style="opacity: 0.9;">(56)</t></span> <br><br>
    <span class="price"><b>$431</b></span> <br><br>
  </div>
  <div class="imageDiv card" onmouseenter="show(this)" onmouseleave="hide(this)">
    <div class="after" onclick="next(this)">↪</div>
   <div class="before" onclick="back(this)">↩</div>
    <img src="4723250.jpg" class="cardimg reqimg" alt="Rajib Khan">
    <img src="banner.jpg" class="cardimg" alt="Rajib Khan">
    <img src="OIP.jpg" class="cardimg" alt="Rajib Khan">
   <span class="pro">
     <img src="4723250.jpg" alt="Rajib Khan">
     <h5>Rajib Khan</h5>     

   </span><br>
   <p>I will do web application in java python c-Sharp with angular.</p> <br><span class="ratting"><b> ★ 5.0</b> <t style="opacity: 0.9;">(56)</t></span> <br><br>
   <span class="price"><b>$431</b></span> <br><br>
 </div>



  <script>

function show(c){
  c.querySelector('.after').style.display = 'flex';
  c.querySelector('.before').style.display = 'flex';
  setTimeout(() => {
    c.querySelector('.after').classList.add('show');
  c.querySelector('.before').classList.add('show');
  }, 100);


  imgs = c.querySelectorAll('.cardimg');
  c.setAttribute('data-count', imgs.length)
 
num = 0
imgs.forEach(element => {
  console.log(num)
  element.setAttribute('data-num', num)
  num += 1;
}); 

total = c.getAttribute('data-count') - 1;
  if (total < 0) total +=1;
          check = c.querySelector('.reqimg').getAttribute('data-num') - 0;
          console.log(`${check},  ${total}`)
          if (check == total) {
            c.querySelector('.after').classList.remove('show');

            setTimeout(() => {
              c.querySelector('.after').style.display = 'none';

            }, 100);

          }
          else if (check == total - total) {

            c.querySelector('.before').classList.remove('show');
            setTimeout(() => {
              c.querySelector('.before').style.display = 'none';

            }, 100);
          }

          else {
            c.querySelector('.after').style.display = 'flex';
            c.querySelector('.before').style.display = 'flex';
            setTimeout(() => {
              c.querySelector('.after').classList.add('show');

c.querySelector('.before').classList.add('show');
            }, 100);

          }
}

function hide(c){
  

  c.querySelector('.after').classList.remove('show');
  c.querySelector('.before').classList.remove('show');


  setTimeout(() => {
    c.querySelector('.after').style.display ='none';
  c.querySelector('.before').style.display = 'none'
  }, 200);
}
function doItAgain(div){
  const img = div.querySelector('.reqimg');
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const width = img.width;
        const height = img.height;

        canvas.width = width;
        canvas.height = height;
        ctx.drawImage(img, 0, 0, width, height);
        const imageData = ctx.getImageData(2, 2, width, height).data;
        const averageRGB = getAverageRGB(imageData);
        img.setAttribute('data-bg', `rgb(${averageRGB.r}, ${averageRGB.g}, ${averageRGB.b})`)
        img.setAttribute('data-shadow', `0px 5px 15px rgba(${averageRGB.r}, ${averageRGB.g}, ${averageRGB.b}, 0.3)`)
        div.style.backgroundColor = `rgb(${averageRGB.r}, ${averageRGB.g}, ${averageRGB.b})`;
        div.style.boxShadow = `0px 10px 30px rgba(${averageRGB.r}, ${averageRGB.g}, ${averageRGB.b}, 0.8)`; // Reduced opacity for the shadow
      
}

    function checkImagesAndSetColors() {
      const divs = document.querySelectorAll('.imageDiv');

      divs.forEach(div => {
        const img = div.querySelector('.reqimg');
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const width = img.width;
        const height = img.height;

        canvas.width = width;
        canvas.height = height;
        ctx.drawImage(img, 0, 0, width, height);
        const imageData = ctx.getImageData(2, 2, width, height).data;
        const averageRGB = getAverageRGB(imageData);
        img.setAttribute('data-bg', `rgb(${averageRGB.r}, ${averageRGB.g}, ${averageRGB.b})`)
        img.setAttribute('data-shadow', `0px 5px 15px rgba(${averageRGB.r}, ${averageRGB.g}, ${averageRGB.b}, 0.3)`)
        div.style.backgroundColor = `rgb(${averageRGB.r}, ${averageRGB.g}, ${averageRGB.b})`;
        div.style.boxShadow = `0px 10px 30px rgba(${averageRGB.r}, ${averageRGB.g}, ${averageRGB.b}, 0.8)`; // Reduced opacity for the shadow
      });
    }

    function getAverageRGB(imageData) {
      let r = 0;
      let g = 0;
      let b = 0;

      for (let i = 0; i < imageData.length; i += 4) {
        r += imageData[i];
        g += imageData[i + 1];
        b += imageData[i + 2];
      }

      const totalPixels = imageData.length / 4;
      r = Math.round(r / totalPixels / 1.1);
      g = Math.round(g / totalPixels / 1.1);
      b = Math.round(b / totalPixels / 1.1);

      return { r, g, b };
    }

    // Call the function when the page loads
    window.onload = function () {
      checkImagesAndSetColors();
    };


    function next(button){
      par = button.parentElement;
      count = par.getAttribute('data-c')
      par.querySelector(`.reqimg`).classList.remove('reqimg')
      count = count-0;
      count = count +1;
      par.setAttribute('data-c',count)
      console.log(par.querySelector(`[data-num = '${count}']`))
      par.querySelector(`[data-num = '${count}']`).classList.add('reqimg')
      total = par.getAttribute('data-count') - 1;
          check = par.querySelector('.reqimg').getAttribute('data-num') - 0;
          console.log(`${check},  ${total}`)
          if (check == total) {
            par.querySelector('.after').classList.remove('show');

            setTimeout(() => {
              par.querySelector('.after').style.display = 'none';

            }, 100);

          }
          else if (check == total - total) {

            par.querySelector('.before').classList.remove('show');
            setTimeout(() => {
              par.querySelector('.before').style.display = 'none';

            }, 100);
          }

          else {
            par.querySelector('.after').style.display = 'flex';
            par.querySelector('.before').style.display = 'flex';
            setTimeout(() => {
              par.querySelector('.after').classList.add('show');

par.querySelector('.before').classList.add('show');
            }, 100);

          }
          doItAgain(par);

    }
    function back(button){
      par = button.parentElement;
      count = par.getAttribute('data-c')
      par.querySelector(`.reqimg`).classList.remove('reqimg')
      count = count-0;
      count = count -1;
      par.setAttribute('data-c',count)
      console.log(par.querySelector(`[data-num = '${count}']`))
      par.querySelector(`[data-num = '${count}']`).classList.add('reqimg')
      total = par.getAttribute('data-count') - 1;
          check = par.querySelector('.reqimg').getAttribute('data-num') - 0;
          console.log(`${check},  ${total}`)
          if (check == total) {
            par.querySelector('.after').classList.remove('show');

            setTimeout(() => {
              par.querySelector('.after').style.display = 'none';

            }, 100);

          }
          else if (check == total - total) {

            par.querySelector('.before').classList.remove('show');
            setTimeout(() => {
              par.querySelector('.before').style.display = 'none';

            }, 100);
          }

          else {
            par.querySelector('.after').style.display = 'flex';
            par.querySelector('.before').style.display = 'flex';
            setTimeout(() => {
              par.querySelector('.after').classList.add('show');

par.querySelector('.before').classList.add('show');
            }, 100);

          }
          doItAgain(par);

    }
  </script>
</body>

</html>